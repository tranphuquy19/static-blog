{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/ket-hop-socket-io-trong-du-an-best-practice","result":{"data":{"markdownRemark":{"id":"ee442ec1-b67f-5010-add5-fdf0b536c633","html":"<p><img src=\"/media/react-socket-1.png\" alt=\"react-socket-1\"></p>\n<p>Đã từng có rất nhiều blogger khác nhau đã từng hướng dẫn về chủ đề này rồi, nhưng mỗi người lại hướng dẫn theo nhiều cách khác nhau. Trong bài viết này, mình sẽ hướng dẫn implement thư viện socket.io vào trong dự án React theo cách tối ưu nhất, dễ mở rộng nhất. Với back-end sử dụng framework ưa thích của mình là NestJS tuy nhiên bạn cũng có thể sử dụng bất kỳ FW khác như ExpressJS hoặc chỉ sử dụng Socket.io server thôi cũng được.</p>\n<p>Bài viết được chia làm hai phần, với phần đầu là triển khai <strong>real-time server</strong> và phần 2 là <strong>real-time client</strong> với thư viện react+socket-io-client</p>\n<h2 id=\"realtime-server\" style=\"position:relative;\"><a href=\"#realtime-server\" aria-label=\"realtime server permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Realtime server</h2>\n<p>Mình sẽ hướng dẫn dựng 1 con server realtime với framework <a href=\"https://nestjs.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">NestJS</a> - bạn có thể tìm hiểu thêm về NestJS <a href=\"https://docs.nestjs.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">tại đây</a>. Tuy nhiên nếu bạn đã có server realtime như đã nói ở trên thì có thể bỏ qua bước này.</p>\n<p>Trong phần này mình cũng hướng dẫn và giải thích một số kiến thức liên quan đến NestJS dành cho bạn nào đang tìm hiểu framework này.</p>\n<blockquote>\n<p>Bài viết coi như bạn đã có kiến thức cơ bản về nodejs nói chung, cũng như đã cài một số tool như <code class=\"language-text\">@nestjs/cli</code> cũng như <code class=\"language-text\">create-react-app</code> và <code class=\"language-text\">yarn</code></p>\n</blockquote>\n<h3 id=\"init-project\" style=\"position:relative;\"><a href=\"#init-project\" aria-label=\"init project permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Init project</h3>\n<p>Dùng @nestjs/cli để khởi tạo dự án</p>\n<deckgo-highlight-code language=\"bash\"  line-numbers=\"true\" editable=\"true\" >\n          <code slot=\"code\">nest new server\ncd server</code>\n        </deckgo-highlight-code>\n<h3 id=\"install-dependencies\" style=\"position:relative;\"><a href=\"#install-dependencies\" aria-label=\"install dependencies permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Install dependencies</h3>\n<p>Chúng ta tiến hành cài đặt mốt số thư viện cần thiết cho chức năng realtime</p>\n<deckgo-highlight-code language=\"bash\"  line-numbers=\"true\" editable=\"true\" >\n          <code slot=\"code\">yarn add @nestjs/platform-socket.io @nestjs/websockets\nyarn add -D @types/socket.io</code>\n        </deckgo-highlight-code>\n<h3 id=\"generate-message-module\" style=\"position:relative;\"><a href=\"#generate-message-module\" aria-label=\"generate message module permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Generate message module</h3>\n<p>Tiếp theo ta chạy các lệnh sau để NestJS có thể sinh mã giúp chúng ta để tiết kiệm thời gian và công sức</p>\n<deckgo-highlight-code language=\"bash\"  line-numbers=\"true\" editable=\"true\" >\n          <code slot=\"code\">nest g mo message # generate module\nnest g co message # generate controller\nnest g service message # generate service\nnest g gateway message # generate gateway</code>\n        </deckgo-highlight-code>\n<p>Giải thích thêm về <code class=\"language-text\">Gateway</code>, đây là class được chú thích (annotated) bởi decorator <code class=\"language-text\">@WebSocketGateway()</code>. Nó làm việc với 2 web-socket platforms phổ biến là <code class=\"language-text\">socket.io</code> và <code class=\"language-text\">ws</code>. Nên khi cài <code class=\"language-text\">@nestjs/websockets</code> nó cũng yêu cầu bạn phải cài thêm <code class=\"language-text\">socket.io</code>, <code class=\"language-text\">ws</code>,… hoặc bạn cũng có thể custom theo cách thức <a href=\"https://docs.nestjs.com/websockets/adapter\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">này</a></p>\n<p><code class=\"language-text\">Gateway</code> cũng được coi là 1 <code class=\"language-text\">provider</code> và hầu hết các khái niệm trong Nest như: <em>dependency injection, decorators, exception filters, pipes, guards and interceptors</em> đều được áp dụng trong class này. Và bản thân <code class=\"language-text\">Gateway</code> cũng có thể được injected trong classes khác như (provider or controller)</p>\n<h3 id=\"project-structure\" style=\"position:relative;\"><a href=\"#project-structure\" aria-label=\"project structure permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Project structure</h3>\n<p>Đến bước này bạn project của bạn có cấu trúc như sau</p>\n<deckgo-highlight-code language=\"bash\"  line-numbers=\"true\" editable=\"true\" >\n          <code slot=\"code\">.\n├── package.json\n├── src\n│   ├── app.controller.ts\n│   ├── app.module.ts\n│   ├── app.service.ts\n│   ├── main.ts\n│   └── message\n│       ├── message.controller.ts\n│       ├── message.gateway.ts\n│       ├── message.module.ts\n│       └── message.service.ts\n└── tsconfig.json</code>\n        </deckgo-highlight-code>","fields":{"slug":"/posts/ket-hop-socket-io-trong-du-an-best-practice","tagSlugs":["/tag/nodejs/","/tag/javascript/","/tag/nestjs/","/tag/socket-io/","/tag/reactjs/"]},"frontmatter":{"date":"2021-03-27T04:01:42.520Z","description":"Kết hợp bộ ba Socket.io+ReactJS+NestJS theo hướng hoàn hảo nhất","tags":["nodejs","javascript","nestjs","socket.io","reactjs"],"title":"Kết hợp Socket.io trong dự án React (best practice)","socialImage":"/media/react-socket-1.png"}}},"pageContext":{"slug":"/posts/ket-hop-socket-io-trong-du-an-best-practice"}},"staticQueryHashes":["251939775","3032201271","401334301"]}