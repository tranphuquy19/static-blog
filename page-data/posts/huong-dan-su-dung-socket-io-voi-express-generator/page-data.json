{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/huong-dan-su-dung-socket-io-voi-express-generator","result":{"data":{"markdownRemark":{"id":"e748554c-6e39-5623-a94a-235d779e2b8e","html":"<p><img src=\"/media/express-socket-io-1.png\" alt=\"express-socket-io\"></p>\n<ul>\n<li>B·∫£n th√¢n <em><a href=\"/tag/expressjs/\">express</a></em> kh√¥ng ƒë∆∞·ª£c x√¢y d·ª±ng theo c·∫•u tr√∫c MVC hay b·∫•t k·ª≥ c·∫•u tr√∫c n√†o kh√°c. V√† r·ªìi <code class=\"language-text\">express-generator</code> nh∆∞ m·ªôt gi·∫£i ph√°p ƒë·ªÉ t·∫°o d·ª±ng project g·∫ßn gi·ªëng v·ªõi MVC, thay v√¨ nh·ªìi code t·∫•t c·∫£ (Route, Middleware, ‚Ä¶) v√†o c√πng 1 file duy nh·∫•t. R·∫•t ti·ªán d·ª•ng ph·∫£i ko n√†o‚Ä¶\t</li>\n<li>C√≤n vi·ªác th√™m <em><a href=\"/tag/socket-io/\">socket.io</a></em> th√¨ sao?? Tr∆∞·ªõc h·∫øt n√≥i qua v·ªÅ <code class=\"language-text\">express-generator</code> th√¨ file <code class=\"language-text\">./bin/www</code> ch√≠nh l√† n∆°i m√°y ch·ªß Express kh·ªüi t·∫°o ch·ª© ko ph·∫£i l√† <code class=\"language-text\">app.js</code> nh∆∞ nhi·ªÅu ng∆∞·ªùi l·∫ßm t∆∞·ªüng, n√™n vi·ªác th√™m <em><a href=\"/tag/socket-io/\">socket.io</a></em> l√† c√≥ ch√∫t kh√≥ khƒÉn v√† trang <em><a href=\"https://socket.io/docs/server-api/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">docs</a></em> c·ªßa Socket.IO c≈©ng ko ch·ªâ r√µ ƒëi·ªÅu n√†y (‚ï•‚ï•).. N·∫øu b·∫°n ƒëang th·∫Øc m·∫Øc nh∆∞ m√¨nh th√¨ b√†i vi·∫øt n√†y l√† c√¢u tr·∫£ l·ªùi cho b·∫°n üëèüëèüëè</li>\n</ul>\n<h2 id=\"1-kh·ªüi-t·∫°o-project--install-socketio\" style=\"position:relative;\"><a href=\"#1-kh%E1%BB%9Fi-t%E1%BA%A1o-project--install-socketio\" aria-label=\"1 kh·ªüi t·∫°o project  install socketio permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. Kh·ªüi t·∫°o project &#x26; install socket.io</h2>\n<deckgo-highlight-code language=\"bash\"  line-numbers=\"true\" editable=\"true\" >\n          <code slot=\"code\">express socket-io-with-express  # kh·ªüi t·∫°o project v·ªõi express-genrator\ncd socket-io-with-express       \nnpm install                     # c√†i ƒë·∫∑t c√°c dependencies\n\nnpm install socket.io --save    # th√™m socket.io</code>\n        </deckgo-highlight-code>\n<h2 id=\"c·∫•u-h√¨nh\" style=\"position:relative;\"><a href=\"#c%E1%BA%A5u-h%C3%ACnh\" aria-label=\"c·∫•u h√¨nh permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>C·∫•u h√¨nh</h2>\n<p>T·∫°o th√™m 1 file c√≥ t√™n <code class=\"language-text\">socket.js</code> t·∫°i folder <code class=\"language-text\">./routes</code> v·ªõi n·ªôi dung nh∆∞ sau</p>\n<deckgo-highlight-code language=\"javascript\"  line-numbers=\"true\" editable=\"true\" >\n          <code slot=\"code\">// ./routes/socket.js\nvar express = require(&#39;express&#39;);\nvar router = express.Router();\n\nmodule.exports = (io) =&gt; {\n    io.on(&#39;connection&#39;, socket =&gt; {\n        let { id } = socket;\n        console.log(&#39;new connection id:&#39;, id);\n\n        socket.on(&#39;disconnect&#39;, socket =&gt; {\n            console.log(&#39;disconnect id:&#39;, id);\n        });\n    });\n\n    return router;\n}</code>\n        </deckgo-highlight-code>\n<p>Trong ƒëo·∫°n code tr√™n, m√¨nh t√°ch code x·ª≠ l√Ω realtime ra th√†nh 1 file ri√™ng ƒë·ªÉ th·ª±c hi·ªán nh∆∞ 1 route, v√† g·∫Øn n√≥ v√†o server th√¥ng qua <code class=\"language-text\">app.use()</code></p>\n<p>T·∫°i <code class=\"language-text\">app.js</code></p>\n<deckgo-highlight-code language=\"javascript\"  line-numbers=\"true\" editable=\"true\" >\n          <code slot=\"code\">// app.js\n...\nvar app = express();\nvar io = require(&#39;socket.io&#39;)();\napp.io = io;\n...\n/* truy·ªÅn th·∫±ng io xu·ªëng cho router socketRouter x·ª≠ l√Ω */\nvar socketRouter = require(&#39;./routes/socket&#39;)(io); \napp.use(&#39;/&#39;, socketRouter); // l∆∞u √Ω l√† path ph·∫£i l√† &#39;/&#39;\n\napp.use(&#39;/&#39;, indexRouter);\napp.use(&#39;/users&#39;, usersRouter);\n...\nmodule.exports = app;</code>\n        </deckgo-highlight-code>\n<p>Trong ƒëo·∫°n code tr√™n m√¨nh ƒë√£ g·∫Øn bi·∫øn <code class=\"language-text\">io</code> cho th·∫±ng <code class=\"language-text\">app</code> r·ªìi th√¨ trong <code class=\"language-text\">./bin/www</code> m√¨nh s·∫Ω l√¥i n√≥ ra r·ªìi <code class=\"language-text\">attach</code> l√™n <code class=\"language-text\">server</code> nh∆∞ sau</p>\n<deckgo-highlight-code language=\"javascript\"  line-numbers=\"true\" editable=\"true\" >\n          <code slot=\"code\">// ./bin/www\n...\nvar server = http.createServer(app);\n\nvar io = app.io;\nio.attach(server);\n...</code>\n        </deckgo-highlight-code>\n<p>Ch·ªânh file <code class=\"language-text\">./views/index.ejs</code> ƒë·ªÉ test v·ªõi n·ªôi dung</p>\n<deckgo-highlight-code language=\"markup\"  line-numbers=\"true\" editable=\"true\" >\n          <code slot=\"code\">&lt;!-- ./views/index.ejs --&gt;\n&lt;!DOCTYPE html&gt;\n&lt;html lang=&quot;en&quot;&gt;\n&lt;head&gt;\n  &lt;meta charset=&quot;UTF-8&quot;&gt;\n  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;\n  &lt;title&gt;Socket.IO love ExpressJS&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  &lt;h1&gt;Socket.IO love ExpressJS @tranphuquy19&lt;/h1&gt;\n  &lt;script src=&quot;socket.io/socket.io.js&quot;&gt;&lt;/script&gt;\n  &lt;script&gt;\n    let url = window.location.origin;\n    let socket = io(url);\n  &lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;</code>\n        </deckgo-highlight-code>\n<p>M·ªü <em><a href=\"http://localhost:3000\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://localhost:3000</a></em> tr√™n tr√¨nh duy·ªát v√† k·∫øt qu·∫£ nh∆∞ sau‚Ä¶</p>\n<p><img src=\"/media/express-socket-io-2.png\" alt=\"Result\"></p>\n<h2 id=\"ch√∫c-b·∫°n-th√†nh-c√¥ng\" style=\"position:relative;\"><a href=\"#ch%C3%BAc-b%E1%BA%A1n-th%C3%A0nh-c%C3%B4ng\" aria-label=\"ch√∫c b·∫°n th√†nh c√¥ng permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ch√∫c b·∫°n th√†nh c√¥ng!</h2>\n<ul>\n<li>Full code: <a href=\"https://github.com/tranphuquy19/socketio-with-express-generator\" target=\"_blank\">Github</a></li>\n</ul>","fields":{"slug":"/posts/huong-dan-su-dung-socket-io-voi-express-generator","tagSlugs":["/tag/nodejs/","/tag/javascript/","/tag/expressjs/","/tag/socket-io/"]},"frontmatter":{"date":"2020-05-09T14:22:38.191Z","description":"H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng Socket.io v·ªõi Express-generator","tags":["nodejs","javascript","expressjs","socket.io"],"title":"S·ª≠ d·ª•ng Socket.io v·ªõi Express-generator","socialImage":"/media/express-socket-io-1.png"}}},"pageContext":{"slug":"/posts/huong-dan-su-dung-socket-io-voi-express-generator"}},"staticQueryHashes":["251939775","3032201271","401334301"]}